((e,t)=>{"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e=e||self).QuillResizeImage=t()})(this,function(){var n=function(e,t){return(n=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])}))(e,t)};var e,a=function(){return(a=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r=((s='#editor-resizer {\n  position: absolute;\n  outline: none;\n  /* Default state has no outline */\n  outline-offset: 1px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: rgba(0, 0, 0, 0.5);\n  /* Only show outline when a handler is active (during resize) */\n}\n#editor-resizer:has(.handler.active) {\n  outline: 2px solid rgba(3, 102, 214, 0.5);\n}\n#editor-resizer .handler {\n  position: absolute;\n  background-color: #e8e8e8;\n  cursor: col-resize;\n  border-radius: 8px;\n  width: 4px;\n  height: 60%;\n}\n#editor-resizer .handler.left-side-bar {\n  left: -10px;\n}\n#editor-resizer .handler.right-side-bar {\n  right: -10px;\n}\n#editor-resizer .handler:hover,\n#editor-resizer .handler.active,\n#editor-resizer .handler:focus {\n  background-color: #0366d6;\n}\n#toolbar {\n  position: fixed;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  justify-content: center;\n  gap: 0.25rem;\n  width: max-content;\n  padding: 4px 8px;\n  border: 1px solid #eee;\n  border-radius: 4px;\n  background-color: #fff;\n  box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);\n  z-index: 100;\n}\n#toolbar .group-divider {\n  width: 2px;\n  height: 16px;\n  background-color: #aaa;\n}\n#toolbar .group {\n  display: flex;\n  border-radius: 6px;\n  white-space: nowrap;\n  text-align: center;\n  flex-direction: row;\n  gap: 0.25rem;\n  color: rgba(0, 0, 0, 0.65);\n}\n#toolbar .group .btn {\n  text-align: center;\n  align-items: center;\n  display: flex;\n  justify-content: center;\n  vertical-align: top;\n  user-select: none;\n  color: inherit;\n  border-radius: 3px;\n  transition: all 0.2s ease;\n  position: relative;\n  padding: 2px;\n}\n#toolbar .group .btn.btn-alt-text {\n  padding: 4px 8px;\n  font-weight: 600;\n}\n#toolbar .group .btn:hover {\n  background-color: rgba(0, 0, 0, 0.05);\n  transform: translateY(-1px);\n  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);\n}\n#toolbar .group .btn:not(.btn-group):active,\n#toolbar .group .btn.active {\n  color: #0366d6;\n  transform: translateY(0);\n}\n#toolbar .group .btn svg {\n  display: inline-block;\n  vertical-align: middle;\n  width: 24px;\n  height: 24px;\n}\n#toolbar .group .input-wrapper {\n  width: 25%;\n  border: 1px solid #eee;\n  position: relative;\n  border-right: 1px solid #bbb;\n  min-width: 4em;\n}\n#toolbar .group .input-wrapper::after {\n  content: " ";\n  position: absolute;\n  height: 1px;\n  background-color: #333;\n  left: 0.5em;\n  right: 1em;\n  bottom: 0.2em;\n}\n#toolbar .group .input-wrapper input {\n  color: inherit;\n  text-align: center;\n  width: 100%;\n  border: none;\n  outline: none;\n  padding: 0 0.5em;\n  padding-right: 1.5em;\n}\n#toolbar .group .input-wrapper input:focus ~ .tooltip {\n  display: block;\n}\n#toolbar .group .input-wrapper .suffix {\n  position: absolute;\n  right: 0.5em;\n}\n#toolbar .group .input-wrapper .tooltip {\n  display: none;\n  position: absolute;\n  top: 100%;\n  left: 0;\n  font-size: small;\n  background-color: #fff;\n  box-shadow: 0 0 3px #a7a7a7;\n  padding: 0 0.6em;\n  border-radius: 5px;\n  zoom: 0.85;\n}\n/* Modal styles */\n.quill-resize-modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 9999;\n}\n.quill-resize-modal {\n  background-color: #fff;\n  border-radius: 4px;\n  box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);\n  width: 400px;\n  max-width: 90%;\n  overflow: hidden;\n}\n.quill-resize-modal .quill-resize-modal-header {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  justify-content: space-between;\n  padding: 12px 8px;\n  border-bottom: 1px solid #eee;\n}\n.quill-resize-modal .quill-resize-modal-body {\n  padding: 12px 36px;\n  display: flex;\n  flex-direction: column;\n}\n.quill-resize-modal .quill-resize-modal-body p {\n  margin: 0;\n}\n#quill-resize-alt-text {\n  width: 300px;\n  padding: 12px;\n  border: 1px solid #ddd;\n  font-size: 14px;\n}\n#quill-resize-alt-text:focus {\n  outline: none;\n  border-color: #0366d6;\n}\n.quill-resize-modal-backArrow {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 28px;\n  height: 28px;\n  padding: 4px;\n  border: 0;\n  cursor: pointer;\n  background-color: transparent;\n  border-radius: 4px;\n}\n.quill-resize-modal-backArrow:hover {\n  background-color: #e8e8e8;\n}\n.quill-resize-modal-backArrow svg {\n  fill: #434343;\n  width: 100%;\n  height: 100%;\n}\n.quill-resize-modal-close {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 24px;\n  height: 24px;\n  padding: 4px;\n  border: 0;\n  cursor: pointer;\n  background-color: transparent;\n  border-radius: 100%;\n}\n.quill-resize-modal-close:hover {\n  background-color: #e8e8e8;\n}\n.quill-resize-modal-close svg {\n  fill: #434343;\n  width: 100%;\n  height: 100%;\n}\n.quill-resize-alt-text-description {\n  font-size: 14px;\n  color: #666;\n}\n.toolbar-separator {\n  display: inline-block;\n  width: 1px;\n  height: 16px;\n  background-color: #ddd;\n  margin: 0 4px;\n  vertical-align: middle;\n}\n/* Modal Styles */\n.quill-resize-modal-overlay {\n  position: fixed;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background-color: rgba(0, 0, 0, 0.5);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  z-index: 9999;\n}\n.quill-resize-modal {\n  background-color: #fff;\n  border-radius: 4px;\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n  width: 100%;\n  max-width: 400px;\n  overflow: hidden;\n  display: flex;\n  flex-direction: column;\n}\n.quill-resize-modal-header {\n  padding: 16px;\n  border-bottom: 1px solid #eee;\n  display: flex;\n  align-items: center;\n  position: relative;\n}\n.quill-resize-modal-title {\n  margin: 0;\n  font-size: 16px;\n  font-weight: 600;\n  flex-grow: 1;\n}\n.quill-resize-modal-body {\n  padding: 16px;\n  flex-grow: 1;\n  max-height: 60vh;\n  overflow-y: auto;\n}\n.quill-resize-form-group label {\n  font-weight: 500;\n  color: #333;\n}\n.quill-resize-input {\n  width: 100%;\n  padding: 12px 12px;\n  border: 1px solid #ddd;\n  font-size: 14px;\n  transition: border-color 0.2s;\n}\n.quill-resize-input:focus {\n  outline: none;\n  border-color: #0366d6;\n}\n.quill-resize-checkbox-label {\n  display: flex;\n  align-items: center;\n  justify-content: start;\n  gap: 8px;\n  margin-bottom: 8px;\n  cursor: pointer;\n}\n.quill-resize-checkbox {\n  width: 20px;\n  height: 20px;\n}\n.quill-resize-checkbox-text {\n  font-size: 14px;\n}\n.quill-resize-delete-message {\n  font-size: 14px;\n  color: #333;\n  margin: 0 0 8px 0;\n}\n.quill-resize-modal-footer {\n  padding: 16px;\n  border-top: 1px solid #eee;\n  display: flex;\n  justify-content: flex-end;\n  gap: 12px;\n}\n.quill-resize-btn {\n  padding: 8px 16px;\n  border: none;\n  border-radius: 4px;\n  font-size: 14px;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.2s;\n}\n.quill-resize-btn-cancel {\n  background-color: #f5f5f5;\n  color: #333;\n}\n.quill-resize-btn-cancel:hover {\n  background-color: #e0e0e0;\n}\n.quill-resize-btn-primary {\n  background-color: #0366d6;\n  color: white;\n}\n.quill-resize-btn-primary:hover {\n  background-color: #0256b9;\n}\n.quill-resize-btn-danger {\n  background-color: #e53935;\n  color: white;\n}\n.quill-resize-btn-danger:hover {\n  background-color: #d32f2f;\n}\n')&&"undefined"!=typeof window&&((e=document.createElement("style")).setAttribute("media","screen"),e.innerHTML=s,document.head.appendChild(e)),t.prototype.findLabel=function(e){return this.config?Reflect.get(this.config,e):null},t);function t(e){this.config=a(a({},l),e)}var l={floatLeft:"left",floatRight:"right",center:"center",restore:"restore",altTip:"Press and hold alt to lock ratio!",inputTip:"Press enter key to apply change!"};var i,o,s;i=HTMLElement,n(o=c,s=i),o.prototype=null===s?Object.create(s):(d.prototype=s.prototype,new d);function d(){this.constructor=o}function c(){var e=null!==i&&i.apply(this,arguments)||this;return e.originSize=null,e}u.prototype.initResizer=function(){this.cleanupExistingElements();var e=document.createElement("div"),t=(e.setAttribute("id","editor-resizer"),e.innerHTML=function(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];return e.replace(/\{(\d+)\}/g,function(e,t){return t<n.length?n[t]:""})}('\n<div class="handler left-side-bar" title="{0}"></div>\n<div class="handler right-side-bar" title="{1}"></div>\n\n',this.i18n.findLabel("altTip")),document.createElement("style")),t=(t.textContent="\n.mat-menu {\n  position: fixed;\n  background-color: #fff;\n  border-radius: 4px;\n  box-shadow: 0 2px 10px rgba(0,0,0,0.2);\n  z-index: 1000;\n  min-width: 120px;\n  overflow: visible; /* Changed to visible to allow submenus to show */\n  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n}\n\n.menu-item-wrapper {\n  padding: 8px 0;\n}\n\n\n\n.menu-item {\n  display: flex;\n  align-items: center;\n  padding: 8px 16px;\n  cursor: pointer;\n  color: #333;\n  font-size: 14px;\n  position: relative;\n}\n\n.menu-item:hover {\n  background-color: #f5f5f5;\n}\n\n.current-color-preview {\n  margin-left: auto;\n  margin-right: 8px;\n}\n\n.color-box {\n  width: 20px;\n  height: 20px;\n  border: 1px solid #ddd;\n  border-radius: 4px;\n  background-color: #000000;\n}\n\n.submenu-arrow {\n  // margin-left: auto;\n  text-align: center;\n  justify-content: center;\n  align-items: center;\n\n  font-size: 18px;\n  color: #888;\n}\n\n.submenu {\n  position: absolute;\n  top: 0;\n  right: -200px; /* Position to the right of main menu */\n  background-color: #fff;\n  border-radius: 4px;\n  box-shadow: 0 5px 15px rgba(0,0,0,0.2);\n  padding: 8px;\n  min-width: auto\n  z-index: 1001; /* Higher than parent menu */\n}\n\n.color-grid {\n  display: flex;\n  flex-direction: row;\n  gap: 12px;  \n  margin: 5px 10px;\n}\n\n.color-option {\n  width: 24px;\n  height: 24px;\n  border-radius: 4px;\n  cursor: pointer;\n  border: 1px solid #ddd;\n  transition: transform 0.1s ease;\n}\n\n.color-option:hover {\n  transform: scale(1.1);\n}\n\n.color-option.active {\n  outline: 2px solid #0052cc;\n  outline-offset: 1px;\n}\n\n.size-grid {\n  display: flex;\n  flex-direction: row;\n  gap: 12px; \n  margin: 5px 10px;\n}\n\n.size-option {\nposition: relative;\n  display: flex;\n  align-items: center;\n  width: 24px;\n  height: 24px;\n  cursor: pointer;\n  border-radius: 4px;\n  border: 1px solid #ddd;\n\n}\n\n.size-option:hover {\n  background-color: #f5f5f5;\n}\n\n.size-preview {\n  width: 20px;\n  position: absolute;\n  top: 10px;\n  left: 1px;\n  \n  background-color: #000;\n  margin-right: 12px;\n  transform: rotate(135deg);\n}\n\n.size-option.active {\n  background-color: #e6f7ff;\n}\n",e.appendChild(t),this.container.appendChild(e),document.createElement("div"));t.setAttribute("id","toolbar"),t.setAttribute("data-quill-resize-toolbar","true"),t.innerHTML=this.generateToolbarHTML(),e.appendChild(t),t.style.position="fixed",t.style.zIndex="1000",t.addEventListener("click",this.toolbarClick.bind(this)),this.resizer=e,this.toolbar=t},u.prototype.cleanupExistingElements=function(){var e=document.getElementById("editor-resizer"),e=(e&&e.parentNode&&e.parentNode.removeChild(e),document.getElementById("toolbar"));e&&e.parentNode&&e.parentNode.removeChild(e)},u.prototype.positionResizerToTarget=function(e){if(e&&this.resizer)try{this.resizer.style.setProperty("left",e.offsetLeft+"px"),this.resizer.style.setProperty("top",e.offsetTop-this.editor.scrollTop+"px"),this.resizer.style.setProperty("width",e.clientWidth+"px"),this.resizer.style.setProperty("height",e.clientHeight+"px");var t=window.getComputedStyle(e),n=t.float,i=t.marginLeft,o=t.marginRight,r=t.display,l=t.textAlign,a=this.resizer.querySelector(".left-side-bar"),s=this.resizer.querySelector(".right-side-bar");if(a&&s){var d,c,p,u,h,g,y,f,m="default",b=function(e){e=e.match(/([\d.]+)/);return e?parseFloat(e[1]):0},v=b(i),x=b(o);switch(console.log("Extracted margin values:",{leftMarginValue:v,rightMarginValue:x}),m="left"===n?"left":"right"===n?"right":"auto"===i&&"auto"===o||0<v&&0<x&&Math.abs(v-x)<1?"center":0<v&&(0===x||o.includes("0px")||"0"===o)?"right":"0px"!==i&&!i.includes("0px")&&"0"!==i&&0!==v||"auto"!==o&&!o.includes("auto")?"auto"!==i&&!i.includes("auto")||"0px"!==o&&!o.includes("0px")&&"0"!==o&&0!==x?"left"===l?"left":"right"===l?"right":"center"===l?"center":"left":"right":"left",console.log("Determined alignment:",{alignmentType:m,float:n,marginLeft:i,marginRight:o,textAlign:l,display:r}),m){case"left":a.style.display="none",s.style.display="block";break;case"right":a.style.display="block",s.style.display="none";break;default:a.style.display="block",s.style.display="block"}this.toolbar&&(d=e.getBoundingClientRect(),c=window.innerWidth,p=window.innerHeight,u=this.toolbar.clientWidth,h=this.toolbar.clientHeight,g=d.left+d.width/2-u/2,y=d.bottom+10,c<(g=g<0?d.left:g)+u&&(g=c-u),p<y+h&&(y=d.top>h+10?d.top-h-10:Math.max(0,p-h-5)),this.toolbar.style.setProperty("left",g+"px"),this.toolbar.style.setProperty("top",y+"px"),f=this.toolbar.querySelector(".border-dropdown-content"))&&"block"===f.style.display&&this.repositionDropdown(f)}}catch(e){console.error("Error positioning resizer:",e)}},u.prototype.bindEvents=function(){var e,i,o,r=this;null!==this.resizer&&this.resizer.addEventListener("mousedown",this.startResize),null!==this.toolbar&&(this.toolbar.addEventListener("change",this.toolbarInputChange),null!=(e=this.toolbar.querySelectorAll(".menu-item[data-submenu]"))&&e.forEach(function(e){function t(e){"click"===e.type&&e.preventDefault(),e.stopPropagation();var t,n=e.currentTarget.getAttribute("data-submenu");n&&(null!=(t=null==(t=r.toolbar)?void 0:t.querySelectorAll(".submenu"))&&t.forEach(function(e){e.style.display="none"}),t=null==(t=r.toolbar)?void 0:t.querySelector("#"+n))&&(t.style.display="block",e=e.currentTarget.getBoundingClientRect(),t.style.top="size-submenu"===n?"45px":"0px",e.right+t.offsetWidth>window.innerWidth?(t.style.right="101%",t.style.left="auto"):(t.style.left="101%",t.style.right="auto"))}e.addEventListener("mouseenter",t),e.addEventListener("click",t)}),null!=(i=null==(e=this.toolbar)?void 0:e.querySelectorAll(".size-option"))&&i.forEach(function(e){e.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault();var t,n=e.currentTarget.getAttribute("data-border-width");n&&(t=r.resizeTarget instanceof HTMLElement&&r.resizeTarget.style.borderColor||"#000000",r.applyBorder(n,t),i.forEach(function(e){return e.classList.remove("active")}),e.currentTarget.classList.add("active"),t=null==(n=r.toolbar)?void 0:n.querySelector(".border-dropdown-content"))&&(t.style.display="none")})}),null!=(o=null==(e=this.toolbar)?void 0:e.querySelectorAll(".color-option")))&&o.forEach(function(e){e.addEventListener("click",function(e){e.stopPropagation(),e.preventDefault();var t,n=e.currentTarget.getAttribute("data-border-color");n&&(t=r.resizeTarget instanceof HTMLElement&&r.resizeTarget.style.borderWidth||"1px",r.applyBorder(t,n),o.forEach(function(e){return e.classList.remove("active")}),e.currentTarget.classList.add("active"),(e=null==(t=r.toolbar)?void 0:t.querySelector("#current-color-preview"))&&(e.style.backgroundColor=n),e=null==(t=r.toolbar)?void 0:t.querySelector(".border-dropdown-content"))&&(e.style.display="none")})}),window.addEventListener("mouseup",this.endResize),window.addEventListener("mousemove",this.resizing),this.editor.addEventListener("scroll",this.onScroll),document.addEventListener("click",this.handleDocumentClick),window.addEventListener("resize",this.handleWindowResize),document.addEventListener("scroll",this.handleDocumentScroll),window.addEventListener("scroll",this.handleDocumentScroll)},u.prototype.onScroll=function(){var e;this.positionResizerToTarget(this.resizeTarget),this.toolbar&&(e=this.toolbar.querySelector(".border-dropdown-content"))&&"block"===e.style.display&&this.repositionDropdown(e)},u.prototype._setStylesForToolbar=function(e,t){var n="_styles_"+e,i=this.resizeTarget.style,o=this.resizeTarget[n],r=i.border,l=i.width,a=i.height;o&&(i.cssText=i.cssText.replaceAll(" ","").replace(o,"")),t&&(i.cssText+=";"+t),r&&"border"!==e&&(i.border=r),l&&(i.width=l),a&&(i.height=a),this.resizeTarget[n]=t,this.positionResizerToTarget(this.resizeTarget),null!=(o=this.options)&&o.onChange(this.resizeTarget)},u.prototype.findQuillEditor=function(){for(var e=this.resizeTarget;e&&!e.classList.contains("ql-editor");)e=e.parentElement;return e},u.prototype.applyWrapLeft=function(){var t=this,n=(console.log("Starting applyWrapLeft"),this.unwrapImage(),this.resizeTarget),e=(this.clearImageStyles(n),n.style.border),i=n.style.width,o=n.style.height;n.style.float="left",n.style.marginRight="12px",n.style.marginBottom="12px",n.style.marginTop="12px",n.style.marginLeft="0";this.resizeTarget._styles_wrap="float:left;margin:12px 12px 12px 0;",e&&(n.style.border=e),i&&(n.style.width=i),o&&(n.style.height=o),n.parentElement&&(n.parentElement.style.overflow="auto"),this.positionResizerToTarget(this.resizeTarget),setTimeout(function(){var e;null!=(e=t.options)&&e.onChange(t.resizeTarget),console.log("Final styles after delay:",n.style.cssText)},50)},u.prototype.applyWrapRight=function(){var t=this,n=(console.log("Starting applyWrapRight"),this.unwrapImage(),this.resizeTarget),e=(this.clearImageStyles(n),n.style.border),i=n.style.width,o=n.style.height;n.style.float="right",n.style.marginLeft="12px",n.style.marginBottom="12px",n.style.marginTop="12px",n.style.marginRight="0";this.resizeTarget._styles_wrap="float:right;margin:12px 0 12px 12px;",e&&(n.style.border=e),i&&(n.style.width=i),o&&(n.style.height=o),n.parentElement&&(n.parentElement.style.overflow="auto"),this.positionResizerToTarget(this.resizeTarget),setTimeout(function(){var e;null!=(e=t.options)&&e.onChange(t.resizeTarget),console.log("Final styles after delay:",n.style.cssText)},50)},u.prototype.ensureProperImageWrapping=function(e,t){console.log("Ensuring proper "+t+" wrapping"),this.clearImageStyles(e);var n=e.style.border,i=e.style.width,o=e.style.height;"left"===(e.style.float=t)?(e.style.marginRight="12px",e.style.marginLeft="0"):(e.style.marginLeft="12px",e.style.marginRight="0"),e.style.marginTop="12px",e.style.marginBottom="12px";e._styles_wrap="float:"+t+";margin:"+("left"===t?"12px 12px 12px 0":"12px 0 12px 12px")+";",e.parentElement&&"p"!==e.parentElement.tagName.toLowerCase()&&(e.parentElement.style.overflow="auto"),n&&(e.style.border=n),i&&(e.style.width=i),o&&(e.style.height=o)},u.prototype.fixParentForFloating=function(e){var t,n;e.parentElement&&(t=e.parentElement,n=window.getComputedStyle(t),"flex"===t.style.display||"flex"===n.display||t.style.flexDirection||"none"!==n.flexDirection?(console.log("Found flex container parent, fixing..."),"p"===t.tagName.toLowerCase()?(t.style.display="block",t.style.flexDirection="",t.style.flexWrap="",t.style.alignItems="",t.style.justifyContent="",t.style.zoom="1",setTimeout(function(){t.style.zoom=""},10)):this.reinsertImageInProperContext(e)):"p"===t.tagName.toLowerCase()&&(t.style.overflow="auto"))},u.prototype.reinsertImageInProperContext=function(e){var t=e.parentElement;if(t&&t.parentElement){var n=e.style.float,i=e.style.margin;try{var o=document.createElement("p");o.style.overflow="auto",t.parentElement.insertBefore(o,t),o.appendChild(e),e.style.float=n,e.style.margin=i,console.log("Reinserted image in a proper floating context")}catch(e){console.error("Failed to reinsert image:",e)}}},u.prototype.clearImageStyles=function(e){e.style.float="",e.style.display="",e.style.margin="",e.style.marginLeft="",e.style.marginRight="",e.style.marginTop="",e.style.marginBottom="",e.style.clear="",e.parentElement&&(e.parentElement.style.textAlign="")},u.prototype.unwrapImage=function(){var e,t,n,i;console.log("Unwrapping image"),this.resizeTarget&&(t=(e=this.resizeTarget).style.border,n=e.style.width,i=e.style.height,this.clearImageStyles(e),t&&(e.style.border=t),n&&(e.style.width=n),i&&(e.style.height=i),delete e._styles_wrap,delete e._styles_align)},u.prototype.saveTextContentBeforeUnwrap=function(){return null},u.prototype.applyBorder=function(t,n){var e;this.resizeTarget instanceof HTMLElement&&(this.resizeTarget.style.border=t+" solid "+n,this.resizeTarget._styles_border=t+" solid "+n,this.toolbar&&(this.toolbar.querySelectorAll(".border-option").forEach(function(e){e.classList.remove("active"),e.getAttribute("data-border-width")===t&&e.classList.add("active")}),this.toolbar.querySelectorAll(".color-option").forEach(function(e){e.classList.remove("active"),e.getAttribute("data-border-color")===n&&e.classList.add("active")})),null!=(e=this.options))&&e.onChange(this.resizeTarget)},u.prototype.repositionDropdown=function(e){var t,n,i,o=this;this.toolbar&&(t=this.toolbar.querySelector(".border-dropdown-toggle"))&&(i=(t=t.getBoundingClientRect()).bottom+5,n=t.left,e.style.position="fixed",e.style.top=i+"px",e.style.left=n+"px",(i=e.getBoundingClientRect()).right>window.innerWidth&&(e.style.left=window.innerWidth-i.width-10+"px"),window.innerHeight<i.bottom&&(e.style.top=t.top-i.height-5+"px"),e.querySelectorAll('.submenu[style*="display: block"]').forEach(function(e){var t,n=null==(n=o.toolbar)?void 0:n.querySelector('.menu-item[data-submenu="'+e.id+'"]');n&&(n=n.getBoundingClientRect(),t=e.getBoundingClientRect(),n.right+t.width>window.innerWidth?(e.style.right="101%",e.style.left="auto"):(e.style.left="101%",e.style.right="auto"),n=n.top+t.height,window.innerHeight<n)&&(e.style.top=window.innerHeight-n-10+"px")}))},u.prototype.toggleBorderDropdown=function(){var e,t,n,i;this.toolbar&&(e=this.toolbar.querySelector(".border-dropdown-content"))&&("none"!==e.style.display&&e.style.display?e.style.display="none":(e.querySelectorAll(".submenu").forEach(function(e){e.style.display="none"}),e.style.display="block",this.repositionDropdown(e),e.style.width="200px",this.resizeTarget instanceof HTMLElement&&(t=e.querySelector("#current-color-preview"))&&(t.style.backgroundColor=this.resizeTarget.style.borderColor||"#000000"),n=this.resizeTarget instanceof HTMLElement&&this.resizeTarget.style.borderWidth||"1px",i=this.resizeTarget instanceof HTMLElement&&this.resizeTarget.style.borderColor||"#000000",e.querySelectorAll(".size-option").forEach(function(e){e.classList.remove("active"),e.getAttribute("data-border-width")===n&&e.classList.add("active")}),e.querySelectorAll(".color-option").forEach(function(e){e.classList.remove("active"),e.getAttribute("data-border-color")===i&&e.classList.add("active")})))},u.prototype.restoreActiveButtonStates=function(){var e,t,n;this.toolbar&&(e=this.resizeTarget.style,this.updateActiveButtonState(null,"align"),this.updateActiveButtonState(null,"wrap"),"left"===e.float?(t=this.toolbar.querySelector('.btn[data-type="wrap"][data-styles*="float:left"]'))&&this.updateActiveButtonState(t,"wrap"):"right"===e.float?(t=this.toolbar.querySelector('.btn[data-type="wrap"][data-styles*="float:right"]'))&&this.updateActiveButtonState(t,"wrap"):(t="block"===e.display)&&"auto"===e.marginLeft&&"auto"===e.marginRight?(n=this.toolbar.querySelector('.btn[data-type="align"][data-styles*="margin:auto"]'))&&this.updateActiveButtonState(n,"align"):t&&"auto"===e.marginLeft?(n=this.toolbar.querySelector('.btn[data-type="align"][data-styles*="margin-left:auto"]'))&&this.updateActiveButtonState(n,"align"):t&&"auto"===e.marginRight&&(n=this.toolbar.querySelector('.btn[data-type="align"][data-styles*="margin-right:auto"]'))&&this.updateActiveButtonState(n,"align"))},u.prototype.toolbarInputChange=function(e){var e=e.target,t=null==(t=null==e?void 0:e.dataset)?void 0:t.type,e=e.value;t&&Number(e)&&this._setStylesForToolbar(t,"width: "+Number(e)+"%;")},u.prototype.updateActiveButtonState=function(e,t){this.toolbar&&(this.toolbar.querySelectorAll(".btn[data-type='"+t+"']").forEach(function(e){return e.classList.remove("active")}),e)&&e.classList.add("active")},u.prototype.generateToolbarHTML=function(){var e={border:!0,align:!0,wrap:!0,imageActions:{copy:!0,link:!0,altText:!0,delete:!0}},t=a(a(a({},e),(null==(t=this.options)?void 0:t.toolbar)||{}),{imageActions:a(a({},e.imageActions),(null==(e=null==(t=this.options)?void 0:t.toolbar)?void 0:e.imageActions)||{})}),e="";return t.border&&(e+='\n      <div class="group">\n        <a class="btn" data-type="border" title="Add border"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" role="presentation"><path d="M8.33333 8C8.15267 8 8 8.14933 8 8.33333V15.6667C8.0007 15.7549 8.03604 15.8392 8.0984 15.9016C8.16076 15.964 8.24514 15.9993 8.33333 16H15.6667C15.8473 16 16 15.8507 16 15.6667V8.33333C16 8.15267 15.8507 8 15.6667 8H8.33333Z" fill="currentColor"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M4 7C4 5.34315 5.34315 4 7 4H17C18.6569 4 20 5.34315 20 7V17C20 18.6569 18.6569 20 17 20H7C5.34315 20 4 18.6569 4 17V7ZM7 6C6.44772 6 6 6.44772 6 7V17C6 17.5523 6.44772 18 7 18H17C17.5523 18 18 17.5523 18 17V7C18 6.44772 17.5523 6 17 6H7Z" fill="currentColor"></path></svg></a>\n        <a class="btn border-dropdown-toggle" data-type="border-dropdown" title="Border options"><svg width="24" height="24" viewBox="0 0 24 24" role="presentation"><path fill="currentcolor" fill-rule="evenodd" d="M8.292 10.293a1.01 1.01 0 0 0 0 1.419l2.939 2.965c.218.215.5.322.779.322s.556-.107.769-.322l2.93-2.955a1.01 1.01 0 0 0 0-1.419.987.987 0 0 0-1.406 0l-2.298 2.317-2.307-2.327a.99.99 0 0 0-1.406 0"></path></svg></a>\n        <div class="mat-menu border-dropdown-content" style="display: none;">\n          <div class="menu-item-wrapper">\n            <div class="menu-item" data-submenu="color-submenu">\n              <span>Color</span>\n              <div class="current-color-preview">\n                <div class="color-box" id="current-color-preview"></div>\n              </div>\n              <span class="submenu-arrow">›</span>\n            </div>\n            <div class="menu-item" data-submenu="size-submenu">\n              <span>Size</span>\n              <span class="submenu-arrow">›</span>\n            </div>\n          </div>\n          \n          \x3c!-- Color submenu --\x3e\n          <div class="submenu" id="color-submenu" style="display: none;">\n            <div class="color-grid">\n              <a class="color-option" data-border-color="#091E4224" style="background-color: #091E4224;"></a>\n              <a class="color-option" data-border-color="#758195" style="background-color: #758195;"></a>\n              <a class="color-option" data-border-color="#172B4D" style="background-color: #172B4D;"></a>\n            </div>\n          </div>\n          \n          \x3c!-- Size submenu --\x3e\n          <div class="submenu" id="size-submenu" style="display: none;">\n            <div class="size-grid">\n              <a class="size-option" data-border-width="1px">\n                <div class="size-preview" style="height: 1px;"></div>\n              </a>\n              <a class="size-option" data-border-width="2px">\n                <div class="size-preview" style="height: 2px;"></div>\n              </a>\n              <a class="size-option" data-border-width="4px">\n                <div class="size-preview" style="height: 4px;"></div>\n              </a>\n            </div>\n          </div>\n        </div>\n      </div>\n      <div class="group-divider"></div>'),t.align&&(e+='\n      <div class="group">\n        <a class="btn" data-type="align" data-styles="float:left"><svg width="24" height="24" role="presentation"><path fill="currentcolor" fill-rule="evenodd" d="M6 17h12a1 1 0 0 1 0 2H6a1 1 0 0 1 0-2m0-8h4a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1m0-4h12a1 1 0 0 1 0 2H6a1 1 0 1 1 0-2"></path></svg></a>\n        <a class="btn" data-type="align" data-styles="display:block;margin:auto;"><svg width="24" height="24" role="presentation"><path fill="currentcolor" fill-rule="evenodd" d="M6 17h12a1 1 0 0 1 0 2H6a1 1 0 0 1 0-2m4-8h4a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1M6 5h12a1 1 0 0 1 0 2H6a1 1 0 1 1 0-2"></path></svg></a>\n        <a class="btn" data-type="align" data-styles="float:right;"><svg width="24" height="24" role="presentation"><path fill="currentcolor" fill-rule="evenodd" d="M6 17h12a1 1 0 0 1 0 2H6a1 1 0 0 1 0-2m8-8h4a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1M6 5h12a1 1 0 0 1 0 2H6a1 1 0 1 1 0-2"></path></svg></a>\n      </div>\n      <div class="group-divider"></div>'),t.wrap&&(e+='\n      <div class="group">\n        <a class="btn" data-type="wrap" data-styles="float:left;margin:12px 12px 12px 0;"><svg width="24" height="24" viewBox="0 0 24 24" role="presentation"><path fill="currentcolor" fill-rule="evenodd" d="M6 17h12a1 1 0 0 1 0 2H6a1 1 0 0 1 0-2m8-8h4a1 1 0 0 1 0 2h-4a1 1 0 0 1 0-2m0 4h4a1 1 0 0 1 0 2h-4a1 1 0 0 1 0-2M6 9h4a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1m0-4h12a1 1 0 0 1 0 2H6a1 1 0 1 1 0-2"></path></svg></a>\n        <a class="btn" data-type="wrap" data-styles="float:right;margin:12px 0 12px 12px;"><svg width="24" height="24" viewBox="0 0 24 24" role="presentation"><path fill="currentcolor" fill-rule="evenodd" d="M6 17h12a1 1 0 0 1 0 2H6a1 1 0 0 1 0-2m0-8h4a1 1 0 0 1 0 2H6a1 1 0 0 1 0-2m0 4h4a1 1 0 0 1 0 2H6a1 1 0 0 1 0-2m8-4h4a1 1 0 0 1 1 1v4a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1v-4a1 1 0 0 1 1-1M6 5h12a1 1 0 0 1 0 2H6a1 1 0 1 1 0-2"></path></svg></a>\n      </div>\n      <div class="group-divider"></div>'),t.imageActions.link&&(e+='<div class="group"> <a class="btn" data-type="link" title="Add link"><svg width="24" height="24" viewBox="0 0 24 24" role="presentation"><g fill="currentcolor" fill-rule="evenodd"><path d="m12.856 5.457-.937.92a1 1 0 0 0 0 1.437 1.047 1.047 0 0 0 1.463 0l.984-.966c.967-.95 2.542-1.135 3.602-.288a2.54 2.54 0 0 1 .203 3.81l-2.903 2.852a2.646 2.646 0 0 1-3.696 0l-1.11-1.09L9 13.57l1.108 1.089c1.822 1.788 4.802 1.788 6.622 0l2.905-2.852a4.558 4.558 0 0 0-.357-6.82c-1.893-1.517-4.695-1.226-6.422-.47"></path><path d="m11.144 19.543.937-.92a1 1 0 0 0 0-1.437 1.047 1.047 0 0 0-1.462 0l-.985.966c-.967.95-2.542 1.135-3.602.288a2.54 2.54 0 0 1-.203-3.81l2.903-2.852a2.646 2.646 0 0 1 3.696 0l1.11 1.09L15 11.43l-1.108-1.089c-1.822-1.788-4.802-1.788-6.622 0l-2.905 2.852a4.558 4.558 0 0 0 .357 6.82c1.893 1.517 4.695 1.226 6.422-.47"></path></g></svg></a></div>\n            <div class="group-divider"></div>'),t.imageActions.altText&&(e+='<div class="group"> <a class="btn btn-alt-text" data-type="alt-text" title="Edit alt text">Edit Alt Text</a></div> <div class="group-divider"></div>'),t.imageActions.copy&&(e+='<div class="group"> <a class="btn" data-type="copy" title="Copy image"><svg width="24" height="24" viewBox="0 0 24 24" role="presentation"><g fill="currentcolor"><path d="M10 19h8V8h-8zM8 7.992C8 6.892 8.902 6 10.009 6h7.982C19.101 6 20 6.893 20 7.992v11.016c0 1.1-.902 1.992-2.009 1.992H10.01A2 2 0 0 1 8 19.008z"></path><path d="M5 16V4.992C5 3.892 5.902 3 7.009 3H15v13zm2 0h8V5H7z"></path></g></svg></a></div>\n            <div class="group-divider"></div>'),t.imageActions.delete&&(e+='<div class="group"><a class="btn" data-type="delete" title="Delete image"><svg width="24" height="24" viewBox="0 0 24 24" role="presentation"><path fill="currentcolor" fill-rule="evenodd" d="M7 7h10a1 1 0 0 1 0 2H7a1 1 0 1 1 0-2m2.78 11a1 1 0 0 1-.97-.757L7.156 10.62A.5.5 0 0 1 7.64 10h8.72a.5.5 0 0 1 .485.621l-1.656 6.622a1 1 0 0 1-.97.757zM11 6h2a1 1 0 0 1 1 1h-4a1 1 0 0 1 1-1"></path></svg></a></div>'),e},u.prototype.toolbarClick=function(e){console.log("toolbarClick"),e.stopPropagation(),e.preventDefault();var t,n,e=e.target.closest(".btn");e?(t=e.getAttribute("data-type"),console.log("Button type:",t),t&&("align"===t||"wrap"===t?(console.log("Handling align/wrap"),this.updateActiveButtonState(e,t),n=e.getAttribute("data-styles")||"",console.log("Styles to apply:",n),"align"===t?(console.log("Applying alignment"),this.applyAlignment(n),this.updateActiveButtonState(null,"wrap")):"wrap"===t&&(console.log("Applying wrap"),n=e.getAttribute("data-styles")||"",console.log("Requested wrap styles:",n),n.includes("float:left")?(console.log("Detected left wrap request"),this.applyWrapLeft()):n.includes("float:right")&&(console.log("Detected right wrap request"),this.applyWrapRight()),this.updateActiveButtonState(e,t),this.updateActiveButtonState(null,"align"))):"copy"===t?this.copyImage():"link"===t?this.addLink():"alt-text"===t?this.editAltText():"delete"===t?this.deleteImage():"border"===t?(console.log("Applying border"),this.applyBorder("1px","#000000")):"border-dropdown"===t&&this.toggleBorderDropdown())):console.log("No button found")},u.prototype.startResize=function(e){e.target.classList.contains("handler")&&1===e.which&&(e.preventDefault(),this.startResizePosition={left:e.clientX,top:e.clientY,width:this.resizeTarget.clientWidth,height:this.resizeTarget.clientHeight},window.addEventListener("mousemove",this.resizing),window.addEventListener("mouseup",this.endResize),this.resizer)&&this.resizer.querySelectorAll(".handler").forEach(function(e){e.classList.add("active")})},u.prototype.endResize=function(){window.removeEventListener("mousemove",this.resizing),window.removeEventListener("mouseup",this.endResize);var e=null==(e=this.resizer)?void 0:e.querySelectorAll(".handler");null!=e&&e.forEach(function(e){e.classList.remove("active")}),this.resizeTarget&&(this.resizeTarget.originSize={width:this.resizeTarget.clientWidth,height:this.resizeTarget.clientHeight}),(this.startResizePosition=null)!=(e=this.options)&&e.onChange&&this.options.onChange(this.resizeTarget)},u.prototype.resizing=function(e){var t,n,i;this.startResizePosition&&(n=(t=e.target).classList.contains("left-side-bar"),t.classList.contains("right-side-bar"),t=e.clientX-this.startResizePosition.left,e=this.startResizePosition.width,i=this.startResizePosition.height/e,n?e-=t:e+=t,n=i*e,e=Math.max(e,30),n=Math.max(n,30),this.resizeTarget.style.setProperty("width",e+"px"),this.resizeTarget.style.setProperty("height",n+"px"),this.positionResizerToTarget(this.resizeTarget))},u.prototype.copyImage=function(){var e,t;this.resizeTarget instanceof HTMLImageElement&&(t=(e=document.createElement("canvas")).getContext("2d"))&&(e.width=this.resizeTarget.naturalWidth,e.height=this.resizeTarget.naturalHeight,t.drawImage(this.resizeTarget,0,0),e.toBlob(function(e){if(e)try{var t;navigator.clipboard&&navigator.clipboard.write&&(t=new ClipboardItem({"image/png":e}),navigator.clipboard.write([t]))}catch(e){console.error("Failed to copy image: ",e)}},"image/png"))},u.prototype.createModal=function(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild},u.prototype.addLink=function(){var i,t,o,r,n,l,e,a,s=this;this.resizeTarget instanceof HTMLImageElement&&(e=(i=this.resizeTarget.closest("a"))?i.getAttribute("href"):"",a=i?i.getAttribute("target"):"_blank",t=this.createModal('\n<div class="quill-resize-modal-overlay">\n  <div class="quill-resize-modal">\n    <div class="quill-resize-modal-header">\n      <button class="quill-resize-modal-backArrow" data-action="back">\n        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#434343"><path d="M640-80 240-480l400-400 71 71-329 329 329 329-71 71Z"/></svg>\n      </button>\n       <input type="text" id="quill-resize-link-url" placeholder="https://" class="quill-resize-input" />\n      \n      <button class="quill-resize-modal-close" data-action="close">\n        <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#434343"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg>\n      </button>\n    </div>\n    <div class="quill-resize-modal-body">\n       \n      <div class="quill-resize-form-group">\n        <label class="quill-resize-checkbox-label">\n          <input type="checkbox" id="quill-resize-link-newtab" checked class="quill-resize-checkbox" />\n          <span class="quill-resize-checkbox-text">Open in new tab</span>\n        </label>\n      </div>\n    </div>\n    \n  </div>\n</div>\n'),document.body.appendChild(t),(o=t.querySelector("#quill-resize-link-url"))&&(o.value=e||"https://",setTimeout(function(){return o.focus()},100),o.addEventListener("input",function(){var e,t=o.value.trim(),n=!r||r.checked;t&&(i?(i.setAttribute("href",t),i.setAttribute("target",n?"_blank":"_self")):((e=document.createElement("a")).setAttribute("href",t),e.setAttribute("target",n?"_blank":"_self"),(t=s.resizeTarget.parentNode)&&(t.insertBefore(e,s.resizeTarget),e.appendChild(s.resizeTarget))),null!=(n=s.options))&&n.onChange(s.resizeTarget)})),(r=t.querySelector("#quill-resize-link-newtab"))&&(r.checked="_blank"===a,r.addEventListener("change",function(){var e=o?o.value.trim():"",t=r.checked;e&&i&&i.setAttribute("target",t?"_blank":"_self")})),n=function(e){e=e.target.getAttribute("data-action");"close"!==e&&"cancel"!==e&&"back"!==e||(document.body.removeChild(t),document.removeEventListener("click",l),s.destroy(),setTimeout(function(){var e;null!=(e=s.options)&&e.onChange(s.resizeTarget)},0))},l=function(e){e.target===t&&(document.body.removeChild(t),document.removeEventListener("click",l))},t.addEventListener("click",l),e=t.querySelector('button[data-action="back"]'),a=t.querySelector('button[data-action="close"]'),e&&e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),document.body.removeChild(t),document.removeEventListener("click",l)}),a&&a.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),document.body.removeChild(t),document.removeEventListener("click",l)}),t.querySelectorAll('[data-action="cancel"], [data-action="save"]').forEach(function(e){e.addEventListener("click",n)}))},u.prototype.editAltText=function(){var t,n,e,i,o,r,l=this;this.resizeTarget instanceof HTMLImageElement&&(t=this.createModal('\n<div class="quill-resize-modal-overlay">\n  <div class="quill-resize-modal">\n    <div class="quill-resize-modal-header">\n    \n      <button class="quill-resize-modal-backArrow" data-action="back">\n      <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#434343"><path d="M640-80 240-480l400-400 71 71-329 329 329 329-71 71Z"/></svg>\n      </button>\n      <input type="text" id="quill-resize-alt-text" placeholder="Describe this image"></input>\n      <button class="quill-resize-modal-close" data-action="close"><svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960" width="24px" fill="#434343"><path d="m256-200-56-56 224-224-224-224 56-56 224 224 224-224 56 56-224 224 224 224-56 56-224-224-224 224Z"/></svg></button>\n    </div>\n    <div class="quill-resize-modal-body">\n      \n        <p class="quill-resize-alt-text-description">Alt text is useful for people using screen readers because of visual limitations.</p>\n       \n    </div>\n    \n  </div>\n</div>\n'),document.body.appendChild(t),e=this.resizeTarget.getAttribute("alt")||"",(n=t.querySelector("#quill-resize-alt-text"))&&(n.value=e,setTimeout(function(){return n.focus()},100),n.addEventListener("input",function(){var e=n.value.trim();l.resizeTarget.setAttribute("alt",e),null!=(e=l.options)&&e.onChange(l.resizeTarget)})),e=function(e){e.preventDefault(),e.stopPropagation();var e=e.target.closest("[data-action]");!e||"back"!==(e=e.getAttribute("data-action"))&&"close"!==e||(document.body.removeChild(t),document.removeEventListener("click",i))},i=function(e){e.target===t&&(document.body.removeChild(t),document.removeEventListener("click",i))},t.addEventListener("click",i),o=t.querySelector(".quill-resize-modal-backArrow"),r=t.querySelector(".quill-resize-modal-close"),o&&o.addEventListener("click",e),r)&&r.addEventListener("click",e)},u.prototype.deleteImage=function(){var e=this.resizeTarget.parentNode;e&&(e.removeChild(this.resizeTarget),this.destroy(),null!=(e=this.options))&&e.onChange(null)},u.prototype.destroy=function(){try{this.resizer&&this.resizer.parentNode&&this.resizer.parentNode.removeChild(this.resizer),this.toolbar&&this.toolbar.parentNode&&(console.log("toolbar destroy"),this.toolbar.parentNode.removeChild(this.toolbar)),window.removeEventListener("mouseup",this.endResize),window.removeEventListener("mousemove",this.resizing),this.editor.removeEventListener("scroll",this.onScroll),document.removeEventListener("click",this.handleDocumentClick),window.removeEventListener("resize",this.handleWindowResize),document.removeEventListener("scroll",this.handleDocumentScroll),window.removeEventListener("scroll",this.handleDocumentScroll),this.resizer=null,this.toolbar=null}catch(e){console.error("Error during cleanup:",e)}},u.prototype.destory=function(){return this.destroy()},u.prototype.applyAlignment=function(e){this.unwrapImage();var t=this.resizeTarget,n=(this.clearImageStyles(t),t.style.border),i=t.style.width,o=t.style.height;e.includes("margin:auto")?(console.log("Applying center alignment"),t.style.display="block",t.style.marginLeft="auto",t.style.marginRight="auto",t.style.marginTop="12px",t.style.marginBottom="12px",t.style.float="none"):e.includes("float:left")?(console.log("Applying left alignment"),t.style.display="block",t.style.float="none",t.style.marginLeft="0",t.style.marginRight="auto",t.style.marginTop="12px",t.style.marginBottom="12px"):e.includes("float:right")&&(console.log("Applying right alignment"),t.style.display="block",t.style.float="none",t.style.marginLeft="auto",t.style.marginRight="0",t.style.marginTop="12px",t.style.marginBottom="12px"),n&&(t.style.border=n),i&&(t.style.width=i),o&&(t.style.height=o);this.resizeTarget._styles_align=e,t.parentElement&&(t.parentElement.style.overflow=""),this.positionResizerToTarget(this.resizeTarget),null!=(n=this.options)&&n.onChange(this.resizeTarget),console.log("After alignment:",t.style.cssText)};var p=u;function u(e,t,n,i){var o=this;this.resizer=null,this.toolbar=null,this.startResizePosition=null,this.handleDocumentClick=function(e){var t,n;o.toolbar&&(t=o.toolbar.querySelector(".border-dropdown-content"))&&"block"===t.style.display&&(n=e.target===t||t.contains(e.target),e=e.target.closest(".border-dropdown-toggle"),n||e||(t.style.display="none"))},this.handleWindowResize=function(){var e;o.positionResizerToTarget(o.resizeTarget),o.toolbar&&(e=o.toolbar.querySelector(".border-dropdown-content"))&&"block"===e.style.display&&(e.style.display="none")},this.handleDocumentScroll=function(){var e;o.positionResizerToTarget(o.resizeTarget),o.toolbar&&(e=o.toolbar.querySelector(".border-dropdown-content"))&&"block"===e.style.display&&o.repositionDropdown(e)},this.i18n=new r((null==i?void 0:i.locale)||l),this.options=i,(this.resizeTarget=e).originSize||(e.originSize={width:e.clientWidth,height:e.clientHeight}),this.editor=n,this.container=t,this.initResizer(),this.positionResizerToTarget(e),this.resizing=this.resizing.bind(this),this.endResize=this.endResize.bind(this),this.startResize=this.startResize.bind(this),this.toolbarClick=this.toolbarClick.bind(this),this.toolbarInputChange=this.toolbarInputChange.bind(this),this.onScroll=this.onScroll.bind(this),this.bindEvents(),this.restoreActiveButtonStates()}var h=function(e,t){this.element=e,this.cb=t,this.hasTracked=!1},g=(y.track=function(e,t){this.iframes.push(new h(e,t)),this.interval||(this.interval=setInterval(function(){y.checkClick()},this.resolution))},y.checkClick=function(){if(document.activeElement){var e,t=document.activeElement;for(e in this.iframes)t===this.iframes[e].element?0==this.iframes[e].hasTracked&&(this.iframes[e].cb.apply(window,[]),this.iframes[e].hasTracked=!0):this.iframes[e].hasTracked=!1}},y.resolution=200,y.iframes=[],y.interval=null,y);function y(){}return function(t,n){var i,o,r=t.root;function l(){var e=(new(t.getContents().constructor)).retain(1);t.updateContents(e)}r.addEventListener("click",function(e){var t=e.target;e.target&&["img","video"].includes(t.tagName.toLowerCase())&&(o=new p(i=t,r.parentElement,r,a(a({},n),{onChange:l})))}),t.on("text-change",function(e,t){r.querySelectorAll("iframe").forEach(function(e){g.track(e,function(){o=new p(i=e,r.parentElement,r,a(a({},n),{onChange:l}))})})}),document.addEventListener("mousedown",function(e){var t,n,e=e.target;e===i||null!=(n=null==(t=null==o?void 0:o.resizer)?void 0:t.contains)&&n.call(t,e)||(null!=(n=null==o?void 0:o.destory)&&n.call(o),i=o=null)},{capture:!0})}});
